# redis RESP (redis serialization protocol)

1. 单行回复
2. 错误信息
3. 整数
4. 多行字符串
5. 数组

## 简介

RESP 主要可以序列化以下几种类型：整数，单行回复(简单字符串)，数组，错误信息，多行字符串。Redis 客户端向服务端发送的是一组由执行的命令组成的字符串数组，服务端根据不同的命令回复不同类型的数据，但协议的每部分都是以 "\r\n" (CRLF) 结尾的。另外 RESP 是二进制安全的，不需要处理从一个进程到另一个进程的传输，因为它使用了前缀长度进行传输。

在 RESP 中, 一些数据的类型通过它的第一个字节进行判断：

- 单行回复：回复的第一个字节是 "+"
- 错误信息：回复的第一个字节是 "-"
- 整形数字：回复的第一个字节是 ":"
- 多行字符串：回复的第一个字节是 "$"
- 数组：回复的第一个字节是 "*"

单行回复

以 "+" 开头，以 "\r\n" 结尾的字符串形式。e.g.

```RESP
+OK\r\n
```

错误信息

错误信息和单行回复很像，不过是把 "+" 替换成了 "-"。而这两者之间真正的区别是，错误信息会被客户端视为异常，并且组成错误类型的是错误消息本身。

```RESP
-Error message\r\n
```

错误信息只在有错误发生的时候才会发送，比如数据类型错误，语法错误，或者命令不存在之类的。而当接收到错误信息的时候，客户端库应该抛出一个异常。

整数

这种类型只是只是使用以 ":" 作为前缀，以CRLF作为结尾的字符串来表示整数。e.g. ":666\r\n" 或者 ":999\r\n" 这种的都是整数回复。很多命令都会返回整数回复，例如 INCR LLEN LPUSH 之类的命令。但是多数情况下，返回的整数回复并没有过多实际含义，例如 LPUSH 就只是为了表示插入了几个值，但也有例如 EXISTS 命令是当结果为 true 的时候返回 1，false 返回 0 . e.g.

```RESP
127.0.0.1:6379> LPUSH info JintaoZhang MoeLove
:2\r\n  # 服务端实际返回, 下同
---
(integer) 2  # redis-cli 客户端显示, 下同

127.0.0.1:6379> LLEN info
:2\r\n
---
(integer) 2

127.0.0.1:6379> EXISTS info
:1\r\n
---
(integer) 1

127.0.0.1:6379> DEL info
:1\r\n
---
(integer) 1

127.0.0.1:6379> EXISTS info
:0\r\n
---
(integer) 0
```

多行字符串

